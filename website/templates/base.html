<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- SEO Meta Tags -->
    <title>{% block title %}Home | CyanoTools{% endblock %}</title>
    <meta name="description" content="{% block description %}CyanoTools is a browser-based platform for analyzing photosynthesis, fluorescence, microscopy, and bioreactor data from wet-lab experiments with plants, cyanobacteria, algae and other microbes.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}CyanoTools, photosynthesis analysis, chlorophyll fluorescence, wet-lab calculators, algae research, plant physiology tools, cyanobacteria, microbiology data analysis{% endblock %}">
    <meta name="author" content="Department of Adaptive Biotechnologies, CzechGlobe">
    <meta name="robots" content="index, follow">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta name="theme-color" content="#0a3c58">
    <meta name="copyright" content="© 2025 CzechGlobe - Department of Adaptive Biotechnologies">
    <meta name="publisher" content="CzechGlobe">
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}CyanoTools - Tools for Cyanobacteria and Algal Research{% endblock %}">
    <meta property="og:description" content="{% block og_description %}CyanoTools is a web platform supporting advanced biological research through specialized tools for photosynthesis, microscopy, spectroscopy and mass spectrometry analysis.{% endblock %}">
    <meta property="og:image" content="{{ url_for('static', filename='img/cyano_preview.png') }}">
    <meta property="og:url" content="{{ request.base_url|replace('http://', 'https://') }}">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}CyanoTools{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Web tools for analyzing cyanobacteria, algae, and photosynthetic systems.{% endblock %}">
    <meta name="twitter:image" content="{{ url_for('static', filename='img/cyano_preview.png') }}">
    <!-- Favicon and Icons -->
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" sizes="32x32" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" sizes="192x192" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <!-- Canonical Link -->
    <link rel="canonical" href="{{ request.base_url|replace('http://', 'https://') }}">
    <!-- Performance Hints -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <!-- GTM preconnect removed — GA loads only after consent -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" />
    <!-- Animate CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="static/css_main.css" />
    <!-- MathJax -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Socket.io -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" 
        integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" 
        crossorigin="anonymous">
    </script>
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- Popper Js -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <!-- Bootstrap Js -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Bootstrap Bundle for later version 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+Ue0jt8z5PJm3Ib0bQ4Bl+f2QUaIH" 
        crossorigin="anonymous">
    </script>
    -->
    <!-- Google Analytics — loaded only after cookie consent -->
    <script>
        function loadGA() {
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            window.gtag = gtag;
            gtag('js', new Date());
            gtag('config', 'G-V1B3ZCRT9S');
            var s = document.createElement('script');
            s.async = true;
            s.src = 'https://www.googletagmanager.com/gtag/js?id=G-V1B3ZCRT9S';
            document.head.appendChild(s);
        }
        if (localStorage.getItem('cyanotools_cookie_consent') === 'accepted') { loadGA(); }
    </script>
    <!-- Custom JS -->
    <script src="{{url_for('static', filename='js_index.js')}}"></script>
    <!-- Base Structured Data (JSON-LD) -->
    {%- set _schema_name -%}{% block schema_name %}CyanoTools{% endblock %}{%- endset -%}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": {{ _schema_name|tojson }},
      "operatingSystem": "Web",
      "applicationCategory": "ScientificSoftware",
      "url": "{{ request.base_url|replace('http://', 'https://') }}",
      "description": {{ self.description()|tojson }},
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "publisher": {
        "@type": "Organization",
        "name": "CzechGlobe - Department of Adaptive Biotechnologies",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ url_for('static', filename='img/cyano_preview.png', _external=True) }}"
        }
      }
    }
    </script>
    <!-- Page-specific structured data -->
    {% block extra_schema %}{% endblock %}
    <!-- Additional page-specific head elements -->
    {% block head %}{% endblock %}
</head>

<body>       
    <!-- Navbar -->
    <div class="max-width">
        <header id="site-header" class="site-header">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container-fluid">   
                    <a class="navbar-brand" href="/"><b style="color: #00b894">Cyano</b><b style="color: #d1d1d1">Tools</b></a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="pamDropdown" data-toggle="dropdown">PAM fluorometry</a>
                                <ul class="dropdown-menu dropdown-menu-dark">
                                    <li><a class="dropdown-item" href="/OJIP_data_analysis">OJIP curves</a></li>
                                    <li><a class="dropdown-item" href="/light_curves_analysis">Light curves (P-I curves)</a></li>
                                    <li><a class="dropdown-item" href="/slow_kin_data_analysis">Slow kinetics (Kautsky)</a></li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="MicroscopyDropdown" data-toggle="dropdown">Image analysis</a>
                                <ul class="dropdown-menu">
                                    <li class="dropdown-submenu">
                                        <a class="dropdown-item dropdown-toggle" href="#" id="FluoMicroscopyDropdown">Cell counting</a>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="/cell_count">Cell counting - round cells</a></li>
                                            <li><a class="dropdown-item" href="/cell_count_filament">Cell counting - filaments</a></li>
                                        </ul>
                                    </li>
                                    <li class="dropdown-submenu">
                                        <a class="dropdown-item dropdown-toggle" href="#" id="fluoMicroscopyDropdown"> Fluorescence microscopy </a>
                                        <ul class="dropdown-menu">
                                            <a class="dropdown-item" href="/pixel_profiles_round_cells"> Pigment profiles - round cells </a>
                                            <a class="dropdown-item" href="/pixel_profiles_filament"> Pigment profiles - filaments </a>
                                            <a class="dropdown-item" href="/cell_size_round_cells"> Cell size - round cells </a>
                                            <a class="dropdown-item" href="/cell_size_filament"> Cell size - filaments </a>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/ex_em_spectra_analysis">Fluorescence spectroscopy</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="MassSpetrometryDropdown" data-toggle="dropdown"> Mass spectrometry </a>
                                <ul class="dropdown-menu">
                                    <a class="dropdown-item" href="/MIMS_data_analysis"> Membrane inlet mass spectrometry (MIMS) </a>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="PBRDropdown" data-toggle="dropdown"> PBRs </a>
                                <ul class="dropdown-menu">
                                    <a class="dropdown-item" href="https://czechglobe-doab.shinyapps.io/PBR-DataAnalysis/" target="_blank"> PSI PBR data analysis </a>
                                    <a class="dropdown-item" href="https://smartbiotech.github.io/PBR-ControlScripts/" target="_blank"> PSI PBR control scripts </a>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/statistics">Statistics</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/calculators"> Calculators </a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="ModelsDropdown" data-toggle="dropdown">Other</a>
                                <ul class="dropdown-menu">
                                    <a class="dropdown-item" href="https://www.optimalga.com/" target="_blank">Optimalga</a>
                                    <li class="dropdown-submenu">
                                        <a class="dropdown-item dropdown-toggle" href="#">Models</a>
                                        <ul class="dropdown-menu">
                                            <a class="dropdown-item" href="https://www.e-cyanobacterium.org/" target="_blank">E-cyanobacterium</a>
                                            <a class="dropdown-item" href="https://czechglobe-doab.shinyapps.io/SeawaterCarbonateSystem/" target="_blank">Seawater carbonate system</a>
                                        </ul>
                                    </li>
                                    <li class="dropdown-submenu">
                                        <a class="dropdown-item dropdown-toggle" href="#">DoAB</a>
                                        <ul class="dropdown-menu">
                                            <a class="dropdown-item" href="https://www.czechglobe.cz/en/institute-structure/research-sector/v-domain-adaptive-and-innovative-techniques/department-of-adaptive-biotechnologies/" target="_blank">DoAB home page</a>
                                            <a class="dropdown-item" href="http://www.pracovistedrasov.pano3d.eu/" target="_blank">DoAB research infrastructure</a>
                                            <a class="dropdown-item" href="https://www.researchgate.net/lab/Jan-Cerveny-Lab" target="_blank">DoAB results and publications</a>
                                            <a class="dropdown-item" href="https://twitter.com/CzechGlobe_DoAB" target="_blank">DoAB social media channel</a>
                                        </ul>
                                    </li>
                                    <li class="dropdown-submenu">
                                        <a class="dropdown-item" href="/development_log">Development Log</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main part of the page -->
        <main id="main-content" class="page-wrapper">
            <!-- Flash messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {% if category == 'error'%}
                            <div class="alert alert-danger alert-dismissable fade show" role="alert">
                                {{ message }}
                                <button type="button" class="close" data-dismiss="alert">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        {% else %}
                            <div class="alert alert-success alert-dismissable fade show" role="alert">
                                {{ message }}
                                <button type="button" class="close" data-dismiss="alert">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        {% endif %}
                    {% endfor%}
                {% endif %}
            {% endwith%}

            <div class="wrapper-box">
                {% block content %}
                {% endblock %}
            </div>
        </main>

        <!-- Footer -->
        <footer id="footer_position">
            <div class="footer-container"> 
                <div class="footer-content">
                    <div class="footer-section">
                        <h4>About DoAB</h4>
                        <a href="https://www.czechglobe.cz/en/institute-structure/research-sector/v-domain-adaptive-and-innovative-techniques/research-group-of-adaptive-biotechnologies/" target="blank">Department of Adaptive Biotechnologies</a><br>
                        <a href="https://www.czechglobe.cz/en/institute-structure/research-sector/v-domain-adaptive-and-innovative-techniques/" target="blank">Domain of Adaptive and Innovative Techniques</a><br>
                    </div>
                    <div class="footer-section">
                        <h4>Documentation</h4>
                        <a href="/development_log" target="blank">Development Log</a><br>
                        <a href="https://github.com/Zastupic/tools-py.e-cyanobacterium.org" target="blank">Documentation (GitHub)</a><br>
                    </div>
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <a href="https://www.czechglobe.cz/en/" target="blank">CzechGlobe</a><br>
                        <a href="https://www.avcr.cz/en/" target="blank">Czech Academy of Sciences</a><br>
                    </div>
                    <div class="footer-section">
                        <h4>Contact</h4>
                        <a href="mailto:zavrel.t@czechglobe.cz">Contact Us</a><br>
                        <a href="mailto:zavrel.t@czechglobe.cz"><i>zavrel.t@czechglobe.cz</i></a><br>
                        <a href="#" id="cookie-settings-link" style="font-size:0.8rem; opacity:0.7;">Cookie settings</a> &middot;
                        <a href="/site_stats" style="font-size:0.8rem; opacity:0.7;">Site statistics</a><br>
                    </div>
                </div>
            </div>
        </footer>
    </div>  

<!-- ── Cookie consent banner ───────────────────────────────────────────────── -->
<div id="cookie-consent-banner" style="display:none; position:fixed; bottom:0; left:0; right:0; z-index:9999; background:#1a1a2e; color:#d1d1d1; padding:12px 20px; box-shadow:0 -2px 10px rgba(0,0,0,0.4);">
    <div style="max-width:1200px; margin:0 auto; display:flex; align-items:center; flex-wrap:wrap; gap:10px;">
        <div style="flex:1; min-width:200px; font-size:0.875rem; line-height:1.5;">
            We use <strong style="color:#fff;">strictly necessary</strong> cookies for session management and optional
            <strong style="color:#fff;">analytics cookies</strong> (Google Analytics) to understand how the tools are used.
            <a href="#" id="cookie-policy-link" style="color:#00b894; white-space:nowrap;">Cookie policy</a>
        </div>
        <div style="display:flex; gap:8px; flex-shrink:0;">
            <button id="cookie-decline-btn" type="button" class="btn btn-sm" style="color:#aaa; background:transparent; border:1px solid #555;">Decline analytics</button>
            <button id="cookie-accept-btn" type="button" class="btn btn-sm" style="background:#00b894; color:#fff; border:none;">Accept analytics</button>
        </div>
    </div>
</div>

<!-- ── Cookie policy modal ────────────────────────────────────────────────── -->
<div class="modal fade" id="cookiePolicyModal" tabindex="-1" role="dialog" aria-labelledby="cookiePolicyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="cookiePolicyModalLabel">Cookie Policy</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="font-size:0.875rem; padding:1.25rem;">
        <p class="text-muted mb-3">CyanoTools uses cookies and browser storage listed below. You can review and change your analytics consent at any time.</p>

        <!-- ── Always active ── -->
        <p class="mb-1" style="font-size:0.7rem; font-weight:600; text-transform:uppercase; letter-spacing:.08em; color:#28a745;">Always active</p>

        <div style="border-left:4px solid #28a745; background:#f8f9fa; border-radius:4px; padding:12px 14px; margin-bottom:16px;">
          <strong>Strictly necessary &amp; functional</strong>
          <p class="text-muted mb-2 mt-1" style="font-size:0.82rem;">Required for the site to function or to remember your preferences locally. Never sent to our server. Cannot be disabled.</p>
          <details>
            <summary style="cursor:pointer; color:#555; font-size:0.82rem;">Show details</summary>
            <table class="table table-sm table-striped mb-0 mt-2">
              <thead class="thead-light"><tr><th>Name / Key</th><th>Purpose</th><th>Duration</th></tr></thead>
              <tbody>
                <tr><td><code>session</code></td><td>Flask session — stores temporary analysis data between page requests</td><td>Session</td></tr>
                <tr><td><code>remember_token</code></td><td>Keeps you logged in if you use the login feature</td><td>Session</td></tr>
                <tr><td><code>cc_pixel_size</code></td><td>Last pixel size (nm) entered in the cell counter</td><td>Persistent</td></tr>
                <tr><td><code>cc_chamber_depth</code></td><td>Last chamber depth setting</td><td>Persistent</td></tr>
                <tr><td><code>cc_minimal_diameter</code></td><td>Last minimum cell diameter setting</td><td>Persistent</td></tr>
                <tr><td><code>cc_threshold_filter</code></td><td>Last selected threshold method</td><td>Persistent</td></tr>
                <tr><td><code>cyanotools_cookie_consent</code></td><td>Your cookie consent decision</td><td>Persistent</td></tr>
              </tbody>
            </table>
          </details>
        </div>

        <!-- ── Analytical ── -->
        <p class="mb-1" style="font-size:0.7rem; font-weight:600; text-transform:uppercase; letter-spacing:.08em; color:#fd7e14;">Analytical</p>

        <div style="border-left:4px solid #fd7e14; background:#f8f9fa; border-radius:4px; padding:12px 14px; margin-bottom:4px;">
          <strong>Analytics (Google Analytics)</strong>
          <p class="text-muted mb-2 mt-1" style="font-size:0.82rem;">Helps us understand which tools are used so we can improve them. No personally identifiable information is collected or shared.</p>
          <details>
            <summary style="cursor:pointer; color:#555; font-size:0.82rem;">Show cookies</summary>
            <table class="table table-sm table-striped mb-0 mt-2">
              <thead class="thead-light"><tr><th>Name</th><th>Purpose</th><th>Duration</th></tr></thead>
              <tbody>
                <tr><td><code>_ga</code></td><td>Distinguishes unique users</td><td>2 years</td></tr>
                <tr><td><code>_gid</code></td><td>Distinguishes users (session-level)</td><td>24 hours</td></tr>
                <tr><td><code>_ga_*</code></td><td>Persists session state for the GA4 property</td><td>2 years</td></tr>
              </tbody>
            </table>
          </details>
        </div>

        <p class="text-muted mt-3 mb-0" style="font-size:0.8rem;">You can withdraw your analytics consent at any time using the button below — this will remove your choice and show the banner again on your next visit.</p>
      </div>
      <div class="modal-footer" style="justify-content:space-between;">
        <button type="button" id="cookie-reset-btn" class="btn btn-sm btn-outline-secondary">Reset my choice</button>
        <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- ── Cookie consent logic ───────────────────────────────────────────────── -->
<script>
(function () {
    var KEY    = 'cyanotools_cookie_consent';
    var banner = document.getElementById('cookie-consent-banner');

    function showBanner() { if (banner) banner.style.display = 'block'; }

    if (!localStorage.getItem(KEY)) showBanner();

    document.getElementById('cookie-accept-btn').addEventListener('click', function () {
        localStorage.setItem(KEY, 'accepted');
        banner.style.display = 'none';
        loadGA();
    });

    document.getElementById('cookie-decline-btn').addEventListener('click', function () {
        localStorage.setItem(KEY, 'declined');
        banner.style.display = 'none';
    });

    var policyLink = document.getElementById('cookie-policy-link');
    if (policyLink) {
        policyLink.addEventListener('click', function (e) {
            e.preventDefault();
            $('#cookiePolicyModal').modal('show');
        });
    }

    var footerLink = document.getElementById('cookie-settings-link');
    if (footerLink) {
        footerLink.addEventListener('click', function (e) {
            e.preventDefault();
            $('#cookiePolicyModal').modal('show');
        });
    }

    var resetBtn = document.getElementById('cookie-reset-btn');
    if (resetBtn) {
        resetBtn.addEventListener('click', function () {
            localStorage.removeItem(KEY);
            $('#cookiePolicyModal').modal('hide');
            showBanner();
        });
    }
})();
</script>

</body>
</html>
